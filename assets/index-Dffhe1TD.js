const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor.7NZAw3hJ.js","assets/vendor-react.ZJSUZwOX.js"])))=>i.map(i=>d[i]);
import{d as D,e as pe,r as h,j as e,L as ae,B as fe,f as ye,g as te,h as be}from"./vendor-react.ZJSUZwOX.js";import{_ as U,t as we,c as je,M as _e,T as H,a as ne,R as oe,B as ke,C as Ne,X as ve,Y as Ce,b as ie,d as q,P as Se,e as Te,f as Ie,h as $e,i as Re,j as O,k as X,l as Y,m as De,n as L,o as E,F as $,p as Me,H as ce,q as V,s as Oe,A as J,Z,D as Fe,u as Pe,v as Le,L as Ee}from"./vendor.7NZAw3hJ.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(n){if(n.ep)return;n.ep=!0;const t=i(n);fetch(n.href,t)}})();function Je(a){const{useState:r,useEffect:i,useCallback:s,useMemo:n,createContext:t,useContext:o}=a,l=t(null);return{JSONICContext:l,useJSONIC:()=>{const c=o(l);if(!c)throw new Error("useJSONIC must be used within JSONICProvider");return c},useCollection:c=>{const g=o(l);return n(()=>g?.collection(c),[g,c])},useQuery:(c,g={},d=[])=>{const[u,x]=r([]),[p,y]=r(!0),[b,f]=r(null),_=o(l),N=s(async()=>{if(_)try{y(!0),f(null);const B=await _.collection(c).find(g).toArray();x(B)}catch(C){f(C),x([])}finally{y(!1)}},[_,c,JSON.stringify(g),...d]);return i(()=>{N()},[N]),{data:u,loading:p,error:b,refetch:N}},useMutation:c=>{const[g,d]=r(!1),[u,x]=r(null),p=o(l),y=s(f=>async()=>{try{return d(!0),x(null),await f()}catch(_){throw x(_),_}finally{d(!1)}},[]),b=n(()=>p?.collection(c),[p,c]);return{insertOne:s(f=>y(()=>b?.insertOne(f))(),[b,y]),updateOne:s((f,_)=>y(()=>b?.updateOne(f,_))(),[b,y]),deleteOne:s(f=>y(()=>b?.deleteOne(f))(),[b,y]),isLoading:g,error:u}}}}window.React=D;window.ReactDOM=pe;window.forwardRef=D.forwardRef;window.createElement=D.createElement;window.createContext=D.createContext;window.JSONICHooks=Je(D);console.log("[Setup] React made globally available with JSONIC compatibility");let z=null,Q=null,Ae=null;function Be({children:a}){const[r,i]=h.useState(!1),[s,n]=h.useState(null);return h.useEffect(()=>{(async()=>{try{if(typeof D>"u"){console.error("React is not available");return}const[o,l]=await Promise.all([U(()=>import("./vendor.7NZAw3hJ.js").then(g=>g.w),__vite__mapDeps([0,1])),U(()=>import("./vendor.7NZAw3hJ.js").then(g=>g.x),__vite__mapDeps([0,1]))]);z=o.QueryClient,Q=o.QueryClientProvider,Ae=l.ReactQueryDevtools;const c=new z({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:3e4}}});n(c),i(!0)}catch(o){console.error("Failed to load React Query:",o),i(!0)}})()},[]),r?!z||!Q||!s?(console.warn("React Query not available, running without query capabilities"),e.jsx(e.Fragment,{children:a})):e.jsxs(Q,{client:s,children:[a,!1]}):e.jsx("div",{children:"Loading..."})}let G=null,qe=null,ze=null;const Qe=async()=>{try{const a=await U(()=>import("./vendor.7NZAw3hJ.js").then(r=>r.w),__vite__mapDeps([0,1]));return G=a.useQuery,qe=a.useMutation,ze=a.useQueryClient,!0}catch(a){return console.warn("React Query not available:",a),!1}};let W=null;function M(a){const[r,i]=h.useState(!1),[s,n]=h.useState({data:void 0,isLoading:!0,error:null,refetch:()=>Promise.resolve()});h.useEffect(()=>{(async()=>{W||(W=Qe());const l=await W;i(l),l||n({data:void 0,isLoading:!1,error:null,refetch:()=>Promise.resolve()})})()},[]);const t=G&&r?G(a):null;return t||s}class I{static instance;db=null;initPromise=null;jsonicModule=null;constructor(){}static getInstance(){return I.instance||(I.instance=new I),I.instance}async initialize(){if(!this.db)return this.initPromise||(this.initPromise=this.performInitialization()),this.initPromise}async performInitialization(){const r=performance.now();console.log("[JSONIC] Starting initialization...");try{const i="/agentx-benchmark-ui/",s=typeof window>"u"&&typeof self<"u";let n;s?n="hybrid":n=new URLSearchParams(window.location.search).get("wrapper")||void 0||"hybrid";let t;s?t=`${i}jsonic-worker-wrapper.js`:n==="lightweight"||n==="v1"?(console.log("[JSONIC] Using LIGHTWEIGHT v1 wrapper for faster init"),t=`${i}jsonic-wrapper.esm.js`):n==="v3"?(console.log("[JSONIC] Using FULL v3.1 wrapper with all features"),t=`${i}jsonic-wrapper-v3.esm.js`):(console.log("[JSONIC] Using HYBRID wrapper (v4) - fast init + progressive features"),t=`${i}jsonic-hybrid/index.js`),console.log("[JSONIC] Loading wrapper from:",t);const o=performance.now(),l=await import(t);if(this.jsonicModule=l.default,console.log(`[JSONIC] Module loaded in ${(performance.now()-o).toFixed(2)}ms`),!this.jsonicModule)throw new Error("JSONIC module not found");let c;s?c="/agentx-benchmark-ui/jsonic_wasm_bg.wasm":c=typeof window<"u"&&window.location.pathname.startsWith("/agentx-benchmark-ui/")?"/agentx-benchmark-ui/jsonic_wasm_bg.wasm":`${i}jsonic_wasm_bg.wasm`;const g=performance.now(),d={wasmUrl:c,debug:!0,enablePersistence:!1,persistenceKey:"agentx_benchmark_db"};(n==="v3"||n==="hybrid")&&(d.cacheSize=100,d.enableQueryCache=!0,d.enableBatchOptimization=!0,d.memoryLimit=100*1024*1024,d.indexHints={testId:"hash",timestamp:"btree",status:"hash",agentId:"hash",type:"hash"},n==="hybrid"&&(d.preloadFeatures=["cache","batch"])),this.jsonicModule.configure(d),console.log(`[JSONIC] Configuration completed in ${(performance.now()-g).toFixed(2)}ms`),console.log("JSONIC version:",this.jsonicModule.version),console.log("WASM URL:",c),console.log("Features: Query caching, Batch operations, Index optimization, OPFS persistence");const u=performance.now();this.db=await this.jsonicModule.createDatabase({enablePersistence:!1,persistenceKey:"agentx_benchmark_db",cacheSize:100,enableQueryCache:!0,enableBatchOptimization:!0,memoryLimit:100*1024*1024,indexHints:{testId:"hash",timestamp:"btree",status:"hash",agentId:"hash",type:"hash"},debug:!0}),console.log(`[JSONIC] Database created in ${(performance.now()-u).toFixed(2)}ms`),console.log("JSONIC v3.1 database initialized with performance optimizations");const x=performance.now(),p=await this.db.stats();console.log(`[JSONIC] Stats retrieved in ${(performance.now()-x).toFixed(2)}ms`),console.log("JSONIC stats:",p);const y=performance.now()-r;console.log(`[JSONIC] Total initialization time: ${y.toFixed(2)}ms`),y>1e3&&console.warn(`[JSONIC] ‚ö†Ô∏è Slow initialization detected: ${y.toFixed(2)}ms`)}catch(i){throw console.error("Failed to initialize JSONIC:",i),console.error(`[JSONIC] Failed after ${(performance.now()-r).toFixed(2)}ms`),i}}async getDatabase(){if(this.db||await this.initialize(),!this.db)throw new Error("JSONIC database not initialized");return this.db}async insert(r){return(await this.getDatabase()).insert(r)}async get(r){return(await this.getDatabase()).get(r)}async update(r,i){if(!await(await this.getDatabase()).update(r,i))throw new Error("Failed to update document")}async delete(r){if(!await(await this.getDatabase()).delete(r))throw new Error("Failed to delete document")}async listIds(){return(await this.getDatabase()).list()}async getStats(){return(await this.getDatabase()).stats()}async query(r){const i=await this.getDatabase(),s=await i.list(),n=[];for(const t of s){const o=await i.get(t);o&&o.content&&r(o.content)&&n.push({id:t,...o.content})}return n}async findDocuments(r,i){return(await this.getDatabase()).query(r,i)}async findOne(r){return(await this.getDatabase()).findOne(r)}find(r={}){const i=this.getDatabase(),s={sort:function(t){return this},limit:function(t){return this},skip:function(t){return this},project:function(t){return this},exec:async function(){return(await i).find(r).exec()},toArray:async function(){return(await i).find(r).toArray()},count:async function(){return(await i).find(r).count()}};let n={};return s.sort=t=>(n.sort=Object.entries(t).map(([o,l])=>[o,l]),s),s.limit=t=>(n.limit=t,s),s.skip=t=>(n.skip=t,s),s.project=t=>(n.projection=t,s),s.exec=async()=>(await i).query(r,n),s.toArray=async()=>(await i).query(r,n),s.count=async()=>(await i).find(r).count(),s}async insertMany(r){return(await this.getDatabase()).insertMany(r)}async updateMany(r,i){return(await this.getDatabase()).updateMany(r,i)}async deleteMany(r){return(await this.getDatabase()).deleteMany(r)}async aggregate(r){return(await this.getDatabase()).aggregate(r)}async getDebugInfo(){return(await this.getDatabase()).getDebugInfo()}async clearCache(){(await this.getDatabase()).clearCache()}async clearProfiler(){(await this.getDatabase()).clearProfiler()}async getBenchmarkStats(r){const i=[];return r&&i.push({$match:{testId:r}}),i.push({$group:{_id:"$testId",avgDuration:{$avg:"$duration"},minDuration:{$min:"$duration"},maxDuration:{$max:"$duration"},totalRuns:{$sum:1},successCount:{$sum:{$cond:[{$eq:["$status","success"]},1,0]}},failureCount:{$sum:{$cond:[{$eq:["$status","failure"]},1,0]}}}},{$sort:{totalRuns:-1}}),this.aggregate(i)}}const k=I.getInstance();async function A(){return(await k.findDocuments({_type:"benchmark_run"},{sort:[["timestamp",-1]]})).map(i=>{const{id:s,_type:n,_runId:t,_timestamp:o,...l}=i;return l})}async function We(a){let r=a;{const t=await A();t.length>0&&(r=t[0].run_id)}const s=(await k.findDocuments({_type:"model_performance",_runId:r},{sort:[["provider",1],["model",1]]})).map(t=>{const{id:o,_type:l,_runId:c,_timestamp:g,...d}=t;return d}),n=new Map;return s.forEach(t=>{const o=`${t.provider}-${t.model}`,l=n.get(o);l?n.set(o,{...l,total_tests:l.total_tests+t.total_tests,successful_tests:l.successful_tests+t.successful_tests,failed_tests:l.failed_tests+t.failed_tests,avg_ttft_ms:(l.avg_ttft_ms+t.avg_ttft_ms)/2,min_ttft_ms:Math.min(l.min_ttft_ms,t.min_ttft_ms),max_ttft_ms:Math.max(l.max_ttft_ms,t.max_ttft_ms),avg_total_time_ms:(l.avg_total_time_ms+t.avg_total_time_ms)/2,total_tokens_generated:l.total_tokens_generated+t.total_tokens_generated,avg_tokens_per_second:(l.avg_tokens_per_second+t.avg_tokens_per_second)/2,avg_quality_score:(l.avg_quality_score+t.avg_quality_score)/2,cost_per_1k_tokens:t.cost_per_1k_tokens,success_rate:(l.successful_tests+t.successful_tests)/(l.total_tests+t.total_tests)*100}):n.set(o,t)}),Array.from(n.values())}async function ee(a){return(await k.findDocuments({_type:"test_result",_runId:a},{sort:[["timestamp",-1]],limit:500})).map(s=>{const{id:n,_type:t,_runId:o,_timestamp:l,...c}=s;return c})}async function Ke(){const a=new Date;a.setDate(a.getDate()-7);const r=a.toISOString();return(await k.findDocuments({_type:"performance_trend",recorded_at:{$gte:r}},{sort:[["recorded_at",-1]],limit:100})).map(n=>{const{id:t,_type:o,_runId:l,_timestamp:c,...g}=n;return g})}async function Ue(a){let r=a;{const t=await A();t.length>0&&(r=t[0].run_id)}if(!r)return[];const i=await ee(r),s=new Map;i.forEach(t=>{const o=`${t.category}-${t.provider}-${t.model}`;s.has(o)||s.set(o,{category:t.category,provider:t.provider,model:t.model,avg_ttft_ms:0,avg_total_time_ms:0,total_tests:0,success_rate:0,_ttft_sum:0,_total_time_sum:0,_success_count:0,_test_count:0});const l=s.get(o);l._test_count++,l._ttft_sum+=t.time_to_first_token_ms||0,l._total_time_sum+=t.total_time_ms||0,t.success&&l._success_count++});const n=[];return s.forEach(t=>{const o=t;n.push({category:o.category,provider:o.provider,model:o.model,avg_ttft_ms:o._test_count>0?o._ttft_sum/o._test_count:0,avg_total_time_ms:o._test_count>0?o._total_time_sum/o._test_count:0,total_tests:o._test_count,success_rate:o._test_count>0?o._success_count/o._test_count*100:0})}),n}function He(a){return new Worker("/agentx-benchmark-ui/assets/migration.worker-DmWTz9j5.js",{type:"module",name:a?.name})}let j=null;function Ve(a){return new Promise((r,i)=>{if(typeof window>"u")return console.error("Worker migration only available in browser"),r(!1);j&&(console.log("Worker already running, terminating..."),j.terminate(),j=null);try{console.log("üöÄ Creating JSONIC migration worker..."),j=new He,console.log("Worker created successfully"),j.onmessage=s=>{s.data.type==="progress"?a?.(s.data.payload):s.data.type==="migrationComplete"&&(s.data.payload?(console.log("‚úÖ Worker migration completed successfully"),r(!0)):(console.error("‚ùå Worker migration failed"),i(new Error("Migration failed in worker"))),j?.terminate(),j=null)},j.onerror=s=>{console.error("‚ùå Worker error:",s),a?.({phase:"error",message:"Worker failed to initialize",percentage:0,current:0,total:0}),i(new Error(`Worker error: ${s.message||"Unknown error"}`)),j?.terminate(),j=null},j.onmessageerror=s=>{console.error("‚ùå Worker message error:",s),a?.({phase:"error",message:"Worker communication error",percentage:0,current:0,total:0}),i(new Error("Worker communication error")),j?.terminate(),j=null},console.log("üì§ Starting worker migration..."),j.postMessage({type:"startMigration"})}catch(s){console.error("‚ùå Failed to create worker:",s),a?.({phase:"error",message:"Failed to create worker",percentage:0,current:0,total:0}),i(s)}})}let se=!1,K=null,le;function Ge(a){le=a}async function F(){if(se)return;K||(K=Ve(le)),await K&&(se=!0)}async function Xe(){try{return await F(),await A()}catch(a){throw console.error("Failed to fetch benchmark runs from JSONIC:",a),a}}async function Ye(a){try{return await F(),await We(a)}catch(r){throw console.error("Failed to fetch model performance from JSONIC:",r),r}}async function de(a){try{return await F(),await ee(a)}catch(r){throw console.error("Failed to fetch test results from JSONIC:",r),r}}async function Ze(){try{return await F(),await Ke()}catch(a){throw console.error("Failed to fetch performance trends from JSONIC:",a),a}}async function et(a){try{return await F(),await Ue(a)}catch(r){throw console.error("Failed to fetch category performance from JSONIC:",r),r}}const tt=window.location.hostname==="localhost"?"http://localhost:3001/api":`${window.location.protocol}//${window.location.hostname}:3001/api`;console.log("=== Database Configuration ===");console.log("API_BASE:",tt);console.log("Current hostname:",window.location.hostname);console.log("Using JSONIC database");console.log("==============================");async function st(){return console.log("Fetching benchmark runs from JSONIC"),await Xe()}async function rt(a){return console.log("Fetching model performance from JSONIC"),await Ye(a)}async function at(a){return console.log("Fetching test results from JSONIC"),await de(a)}async function nt(){return console.log("Fetching performance trends from JSONIC"),await Ze()}async function ot(a){return console.log("Fetching category performance from JSONIC"),await et(a)}function S(...a){return we(je(a))}function T(a){return a<1e3?`${a.toFixed(0)}ms`:`${(a/1e3).toFixed(2)}s`}function me(a){return a<.01?`$${(a*1e3).toFixed(2)}/1K`:`$${a.toFixed(4)}`}function R(a){return`${a.toFixed(1)}%`}function ge(a){return a<1e3?a.toString():`${(a/1e3).toFixed(1)}K`}function P({title:a,value:r,icon:i,trend:s=0,format:n,invertTrend:t=!1}){const o=()=>{switch(n){case"percentage":return R(r);case"duration":return T(r);case"currency":return me(r);default:return r.toLocaleString()}},l=()=>Math.abs(s)<.5?e.jsx(_e,{className:"h-4 w-4"}):s>0?e.jsx(H,{className:"h-4 w-4"}):e.jsx(ne,{className:"h-4 w-4"}),c=()=>{if(Math.abs(s)<.5)return"text-gray-500";const g=s>0;return(t?!g:g)?"text-success-500":"text-error-500"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:i})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o()}),s!==0&&e.jsxs("div",{className:S("flex items-center text-sm",c()),children:[l(),e.jsxs("span",{className:"ml-1",children:[Math.abs(s).toFixed(1),"%"]})]})]})]})}function re({performance:a,title:r,metric:i}){const s=a.map(o=>{const l=o.model.replace(/-\d{8}$/,"").replace("claude-3-5-","Claude ").replace("gemini-","Gemini ");switch(i){case"ttft":return{model:l,value:o.avg_ttft_ms,min:o.min_ttft_ms,max:o.max_ttft_ms};case"throughput":return{model:l,value:o.avg_tokens_per_second};case"success":return{model:l,value:o.success_rate};case"cost":return{model:l,value:o.cost_per_1k_tokens*1e3};default:return{model:l,value:0}}}),n=o=>{switch(i){case"ttft":case"throughput":return T(o);case"success":return R(o);case"cost":return`$${o.toFixed(3)}`;default:return o.toFixed(2)}},t=()=>{switch(i){case"ttft":return"Time (ms)";case"throughput":return"Tokens/sec";case"success":return"Success Rate (%)";case"cost":return"Cost ($/1K tokens)";default:return""}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:r}),e.jsx(oe,{width:"100%",height:300,children:e.jsxs(ke,{data:s,margin:{top:10,right:30,left:0,bottom:40},children:[e.jsx(Ne,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(ve,{dataKey:"model",angle:-45,textAnchor:"end",height:100,className:"text-xs",tick:{fill:"#9ca3af"}}),e.jsx(Ce,{label:{value:t(),angle:-90,position:"insideLeft",style:{fill:"#9ca3af",fontSize:12}},tick:{fill:"#9ca3af"}}),e.jsx(ie,{formatter:n,contentStyle:{backgroundColor:"rgba(31, 41, 55, 0.95)",border:"1px solid rgba(75, 85, 99, 0.3)",borderRadius:"6px"},labelStyle:{color:"#d1d5db"}}),e.jsx(q,{dataKey:"value",fill:"#3b82f6",radius:[4,4,0,0]}),i==="ttft"&&e.jsxs(e.Fragment,{children:[e.jsx(q,{dataKey:"min",fill:"#10b981",radius:[4,4,0,0],opacity:.5}),e.jsx(q,{dataKey:"max",fill:"#ef4444",radius:[4,4,0,0],opacity:.5})]})]})})]})}function it({performance:a}){const r=[...a].sort((s,n)=>n.success_rate-s.success_rate),i=s=>s>=95?"bg-success-50 text-success-700":s>=80?"bg-warning-50 text-warning-700":"bg-error-50 text-error-700";return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Model"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Success Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Avg TTFT"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Throughput"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Tokens"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cost/1K"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Quality"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.model.replace(/-\d{8}$/,"")}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.provider})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:S("inline-flex px-2 py-1 text-xs font-semibold rounded-full",i(s.success_rate)),children:R(s.success_rate)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:T(s.avg_ttft_ms)}),e.jsxs("span",{className:"text-xs text-gray-500",children:[T(s.min_ttft_ms)," - ",T(s.max_ttft_ms)]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:[s.avg_tokens_per_second.toFixed(1)," tok/s"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:ge(s.total_tokens_generated)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("span",{className:S("font-medium",s.cost_per_1k_tokens<.002?"text-success-600":s.cost_per_1k_tokens<.005?"text-warning-600":"text-error-600"),children:["$",(s.cost_per_1k_tokens*1e3).toFixed(3)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.avg_quality_score>0?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 w-16",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${s.avg_quality_score*100}%`}})}),e.jsxs("span",{className:"ml-2 text-xs text-gray-600 dark:text-gray-400",children:[(s.avg_quality_score*100).toFixed(0),"%"]})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"N/A"})})]},`${s.provider}-${s.model}`))})]})})}function ct({categories:a}){const r=a.reduce((t,o)=>(t[o.category]||(t[o.category]={category:o.category,avgTTFT:0,avgSuccessRate:0,totalTests:0,count:0}),t[o.category].avgTTFT+=o.avg_ttft_ms,t[o.category].avgSuccessRate+=o.success_rate,t[o.category].totalTests+=o.total_tests,t[o.category].count++,t),{}),i=Object.values(r).map(t=>({name:t.category.charAt(0).toUpperCase()+t.category.slice(1),value:t.totalTests,avgTTFT:t.avgTTFT/t.count,successRate:t.avgSuccessRate/t.count})),s=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"],n=({active:t,payload:o})=>{if(t&&o&&o[0]){const l=o[0].payload;return e.jsxs("div",{className:"bg-gray-900 text-white p-3 rounded-lg shadow-lg border border-gray-700",children:[e.jsx("p",{className:"font-semibold",children:l.name}),e.jsxs("p",{className:"text-sm",children:["Tests: ",l.value]}),e.jsxs("p",{className:"text-sm",children:["Avg TTFT: ",T(l.avgTTFT)]}),e.jsxs("p",{className:"text-sm",children:["Success: ",R(l.successRate)]})]})}return null};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Performance by Category"}),e.jsx(oe,{width:"100%",height:300,children:e.jsxs(Se,{children:[e.jsx(Te,{data:i,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:o})=>`${t}: ${(o*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:i.map((t,o)=>e.jsx(Ie,{fill:s[o%s.length]},`cell-${o}`))}),e.jsx(ie,{content:e.jsx(n,{})})]})}),e.jsx("div",{className:"mt-4 space-y-2",children:i.map((t,o)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:s[o%s.length]}}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t.name})]}),e.jsxs("div",{className:"text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:t.value})," tests ‚Ä¢",e.jsx("span",{className:"ml-1",children:R(t.successRate)})]})]},t.name))})]})}function lt({runs:a}){const r=s=>{const n=s.successful_runs/s.total_runs*100;return n>=95?e.jsx(O,{className:"h-5 w-5 text-success-500"}):n>=80?e.jsx(X,{className:"h-5 w-5 text-warning-500"}):e.jsx(Y,{className:"h-5 w-5 text-error-500"})},i=s=>{const n=s.successful_runs/s.total_runs*100;return n>=95?"border-success-200 bg-success-50":n>=80?"border-warning-200 bg-warning-50":"border-error-200 bg-error-50"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Benchmark Runs"}),e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((s,n)=>e.jsxs("div",{className:S("flex items-center justify-between p-3 rounded-lg border transition-colors hover:shadow-md cursor-pointer",n===0?i(s):"border-gray-200 dark:border-gray-700 hover:border-primary-300"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[r(s),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.name||`Benchmark #${s.id}`}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:$e(new Date(s.timestamp),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[s.successful_runs,"/",s.total_runs]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[R(s.successful_runs/s.total_runs*100)," success"]})]}),e.jsx(Re,{className:"h-5 w-5 text-gray-400"})]})]},s.id))}),a.length>5&&e.jsxs("button",{className:"mt-4 w-full py-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:["View all ",a.length," runs ‚Üí"]})]})}function dt({trends:a}){const r=a.filter(n=>n.is_regression),i=a.filter(n=>!n.is_regression&&n.change_percentage&&n.change_percentage<-10);if(r.length===0&&i.length===0)return null;const s=(n,t)=>`${n}/${t.replace(/-\d{8}$/,"")}`;return e.jsxs("div",{className:"space-y-4",children:[r.length>0&&e.jsx("div",{className:"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(De,{className:"h-5 w-5 text-error-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-error-800 dark:text-error-200 mb-2",children:"Performance Regressions Detected"}),e.jsx("div",{className:"space-y-1",children:r.slice(0,3).map((n,t)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-error-700 dark:text-error-300",children:[s(n.provider,n.model)," - ",n.metric_name]}),e.jsxs("span",{className:"font-medium text-error-800 dark:text-error-200",children:[e.jsx(ne,{className:"inline h-4 w-4 mr-1"}),Math.abs(n.change_percentage||0).toFixed(1),"% slower"]})]},t))})]})]})}),i.length>0&&e.jsx("div",{className:"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(H,{className:"h-5 w-5 text-success-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-success-800 dark:text-success-200 mb-2",children:"Performance Improvements"}),e.jsx("div",{className:"space-y-1",children:i.slice(0,3).map((n,t)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-success-700 dark:text-success-300",children:[s(n.provider,n.model)," - ",n.metric_name]}),e.jsxs("span",{className:"font-medium text-success-800 dark:text-success-200",children:[e.jsx(H,{className:"inline h-4 w-4 mr-1"}),Math.abs(n.change_percentage||0).toFixed(1),"% faster"]})]},t))})]})]})})]})}function mt({runId:a}){const[r,i]=h.useState([]),[s,n]=h.useState(!0),[t,o]=h.useState(new Set),[l,c]=h.useState("all"),[g,d]=h.useState("time"),[u,x]=h.useState("desc");h.useEffect(()=>{p()},[a]);const p=async()=>{try{n(!0);let m;if(a)m=await de(a);else{const w=await A();if(w&&w.length>0){const ue=w.sort((xe,he)=>new Date(he.timestamp).getTime()-new Date(xe.timestamp).getTime())[0].run_id;m=await ee(ue)}else m=[]}i(m)}catch(m){console.error("Error fetching test results:",m),i(gt())}finally{n(!1)}},y=m=>{const w=new Set(t);w.has(m)?w.delete(m):w.add(m),o(w)},f=[...r.filter(m=>l==="all"?!0:l==="success"?m.success:l==="failed"?!m.success:m.category===l)].sort((m,w)=>{let v=0;switch(g){case"time":v=m.total_time_ms-w.total_time_ms;break;case"tokens":v=m.tokens_generated-w.tokens_generated;break;case"category":v=m.category.localeCompare(w.category);break;case"status":v=(m.success?1:0)-(w.success?1:0);break}return u==="asc"?v:-v}),_=[...new Set(r.map(m=>m.category))],N=m=>m?e.jsx(O,{className:"h-5 w-5 text-success-500"}):e.jsx(Y,{className:"h-5 w-5 text-error-500"}),C=m=>({math:e.jsx(ce,{className:"h-4 w-4"}),coding:e.jsx(Me,{className:"h-4 w-4"}),technical:e.jsx($,{className:"h-4 w-4"}),reasoning:e.jsx(X,{className:"h-4 w-4"})})[m]||e.jsx($,{className:"h-4 w-4"}),B=m=>({math:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",coding:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",technical:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",reasoning:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",creative:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",mcp_tools:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300"})[m]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300";return s?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading test results..."})]})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Detailed Test Results (",f.length," tests)"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>c("all"),className:S("px-3 py-1 rounded-md text-sm font-medium transition-colors",l==="all"?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["All (",r.length,")"]}),e.jsxs("button",{onClick:()=>c("success"),className:S("px-3 py-1 rounded-md text-sm font-medium transition-colors",l==="success"?"bg-success-100 text-success-700 dark:bg-success-900 dark:text-success-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["Success (",r.filter(m=>m.success).length,")"]}),e.jsxs("button",{onClick:()=>c("failed"),className:S("px-3 py-1 rounded-md text-sm font-medium transition-colors",l==="failed"?"bg-error-100 text-error-700 dark:bg-error-900 dark:text-error-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["Failed (",r.filter(m=>!m.success).length,")"]})]}),e.jsxs("select",{value:l,onChange:m=>c(m.target.value),className:"px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:"all",children:"All Categories"}),_.map(m=>e.jsx("option",{value:m,children:m},m))]}),e.jsxs("select",{value:`${g}-${u}`,onChange:m=>{const[w,v]=m.target.value.split("-");d(w),x(v)},className:"px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:"time-desc",children:"Slowest First"}),e.jsx("option",{value:"time-asc",children:"Fastest First"}),e.jsx("option",{value:"tokens-desc",children:"Most Tokens"}),e.jsx("option",{value:"tokens-asc",children:"Least Tokens"}),e.jsx("option",{value:"category-asc",children:"Category A-Z"}),e.jsx("option",{value:"status-desc",children:"Success First"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Model"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Prompt"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"TTFT"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tokens"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cost"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:f.map(m=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N(m.success)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:m.model.replace(/-\d{8}$/,"")}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[m.provider," ‚Ä¢ Iteration ",m.iteration]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:S("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",B(m.category)),children:[C(m.category),e.jsx("span",{className:"ml-1",children:m.category})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs truncate text-sm text-gray-900 dark:text-gray-300",children:m.prompt_text||m.prompt_id})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:T(m.time_to_first_token_ms)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:T(m.total_time_ms)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:e.jsxs("div",{children:[e.jsx("div",{children:ge(m.tokens_generated)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[m.tokens_per_second?.toFixed(1)," tok/s"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:me(m.estimated_cost_usd)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>y(m.id),className:"text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:t.has(m.id)?e.jsx(L,{className:"h-5 w-5"}):e.jsx(E,{className:"h-5 w-5"})})})]},m.id),t.has(m.id)&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Full Prompt:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("pre",{className:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:m.prompt_text})})]}),m.response&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Response:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("pre",{className:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:m.response})})]}),m.error_message&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-error-700 dark:text-error-300 mb-2",children:"Error:"}),e.jsx("div",{className:"bg-error-50 dark:bg-error-900/20 p-3 rounded-md border border-error-200 dark:border-error-800",children:e.jsx("pre",{className:"text-sm text-error-800 dark:text-error-200 whitespace-pre-wrap",children:m.error_message})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Timestamp:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-gray-200",children:new Date(m.timestamp).toLocaleString()})]}),m.quality_score&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Quality Score:"}),e.jsxs("span",{className:"ml-2 text-gray-900 dark:text-gray-200",children:[(m.quality_score*100).toFixed(1),"%"]})]})]})]})})})]}))})]})}),f.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No test results found for the selected filter."})]})}function gt(){const a=["math","coding","reasoning","technical","creative","mcp_tools"],r={math:"Calculate the factorial of 12",coding:"Write a Python function to reverse a linked list",reasoning:"If all birds can fly and penguins are birds, can penguins fly?",technical:"Explain the difference between TCP and UDP protocols",creative:"Write a haiku about machine learning",mcp_tools:"List all virtual machines with more than 16GB RAM"};return Array.from({length:20},(i,s)=>{const n=a[s%a.length],t=Math.random()>.15;return{id:s+1,run_id:`bench-${Date.now()}`,timestamp:new Date(Date.now()-Math.random()*864e5).toISOString(),provider:["anthropic","gemini","ollama"][s%3],model:["claude-3-5-haiku-20241022","gemini-2.0-flash-exp","llama2"][s%3],prompt_id:`${n}_test`,prompt_text:r[n],category:n,iteration:s%3+1,time_to_first_token_ms:500+Math.random()*3e3,total_time_ms:1e3+Math.random()*5e3,tokens_generated:50+Math.floor(Math.random()*500),tokens_per_second:20+Math.random()*30,quality_score:t?.7+Math.random()*.3:void 0,success:t,error_message:t?void 0:"Rate limit exceeded",response:t?`This is a sample response for ${n} prompt...`:void 0,estimated_cost_usd:Math.random()*.01}})}function ut({runId:a}){const[r,i]=h.useState(null),{data:s,isLoading:n}=M({queryKey:["testResults",a],queryFn:()=>a?at(a):Promise.resolve([]),enabled:!!a}),t=[];if(s){const c=new Map;s.forEach(g=>{const d=g.prompt_id;c.has(d)||c.set(d,{prompt_id:g.prompt_id,prompt_text:g.prompt_text,category:g.category,total_tests:0,successful_tests:0,failed_tests:0,avg_time_ms:0,avg_tokens:0,providers:[]});const u=c.get(d);u.total_tests++,g.success?u.successful_tests++:u.failed_tests++,u.avg_time_ms+=g.total_time_ms||0,u.avg_tokens+=g.tokens_generated||0;const x=`${g.provider}/${g.model}`;u.providers.includes(x)||u.providers.push(x)}),c.forEach(g=>{g.avg_time_ms=g.avg_time_ms/g.total_tests,g.avg_tokens=Math.round(g.avg_tokens/g.total_tests)}),t.push(...Array.from(c.values()))}const o=c=>({math:e.jsx(ce,{className:"h-4 w-4"}),coding:e.jsx($,{className:"h-4 w-4"}),reasoning:e.jsx(Z,{className:"h-4 w-4"}),technical:e.jsx(J,{className:"h-4 w-4"}),creative:e.jsx($,{className:"h-4 w-4"}),mcp_tools:e.jsx(Oe,{className:"h-4 w-4"})})[c]||e.jsx($,{className:"h-4 w-4"}),l=c=>({math:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",coding:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",reasoning:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",technical:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",creative:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",mcp_tools:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200"})[c]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";return n?e.jsxs("div",{className:"animate-pulse space-y-3 p-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"})]}):t.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(V,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No test prompts found for this run"})]}):e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:t.length})," unique prompts tested across ",e.jsx("strong",{children:t.reduce((c,g)=>c+g.providers.length,0)})," model configurations"]}),t.map(c=>{const g=c.successful_tests/c.total_tests*100,d=r===c.prompt_id;return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-4 cursor-pointer select-none",onClick:()=>i(d?null:c.prompt_id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${l(c.category)}`,children:[o(c.category),c.category]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",c.prompt_id]})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:c.prompt_text}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[g>=80?e.jsx(O,{className:"h-3 w-3 text-green-500"}):g>=50?e.jsx(V,{className:"h-3 w-3 text-yellow-500"}):e.jsx(Y,{className:"h-3 w-3 text-red-500"}),g.toFixed(0),"% success"]}),e.jsxs("span",{children:[c.total_tests," runs"]}),e.jsxs("span",{children:[(c.avg_time_ms/1e3).toFixed(1),"s avg"]}),e.jsxs("span",{children:[c.avg_tokens," tokens avg"]})]})]}),e.jsx("div",{className:"ml-4 text-gray-400",children:e.jsx("svg",{className:`h-5 w-5 transform transition-transform ${d?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),d&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.jsx("strong",{children:"Full Prompt:"})}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-900 rounded text-sm text-gray-700 dark:text-gray-300 font-mono",children:c.prompt_text}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Test Results"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400",children:["‚úì ",c.successful_tests," passed"]}),e.jsxs("span",{className:"text-sm text-red-600 dark:text-red-400",children:["‚úó ",c.failed_tests," failed"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Tested Models"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:c.providers.map(u=>e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded",children:u},u))})]})]})]})})]},c.prompt_id)})]})}function xt(){const[a,r]=h.useState(!1),[i,s]=h.useState(!0),[n,t]=h.useState(!0),{data:o,isLoading:l}=M({queryKey:["benchmarkRuns"],queryFn:st,refetchInterval:6e4}),{data:c,isLoading:g}=M({queryKey:["modelPerformance"],queryFn:()=>rt(),refetchInterval:6e4}),{data:d,isLoading:u}=M({queryKey:["performanceTrends"],queryFn:nt,refetchInterval:6e4}),{data:x}=M({queryKey:["categoryPerformance"],queryFn:()=>ot(),refetchInterval:6e4}),p=o?.[0],y=p?.total_runs||0,b=p?p.successful_runs/p.total_runs*100:0,f=c?c.reduce((N,C)=>N+C.avg_ttft_ms,0)/c.length:0,_=c?c.reduce((N,C)=>N+C.total_cost_usd,0):0;return l||g?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-8 w-8 text-primary-600 mr-3"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"AgentX Benchmark Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(ae,{to:"/jsonic-bench",className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all shadow-md hover:shadow-lg",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"JSONIC Benchmarks"})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last updated: ",p?new Date(p.timestamp).toLocaleString():"Never"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(P,{title:"Total Tests",value:y,icon:e.jsx(J,{className:"h-5 w-5"}),trend:o&&o.length>1?(o[0].total_runs-o[1].total_runs)/o[1].total_runs*100:0,format:"number"}),e.jsx(P,{title:"Success Rate",value:b,icon:e.jsx(O,{className:"h-5 w-5"}),trend:o&&o.length>1?b-o[1].successful_runs/o[1].total_runs*100:0,format:"percentage",invertTrend:!1}),e.jsx(P,{title:"Avg TTFT",value:f,icon:e.jsx(X,{className:"h-5 w-5"}),trend:d&&d.find(N=>N.metric_name==="avg_ttft_ms")?.change_percentage||0,format:"duration",invertTrend:!0}),e.jsx(P,{title:"Total Cost",value:_,icon:e.jsx(Fe,{className:"h-5 w-5"}),trend:0,format:"currency",invertTrend:!0})]}),d&&!u&&e.jsx("div",{className:"mb-8",children:e.jsx(dt,{trends:d})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(re,{performance:c||[],title:"Response Time by Model",metric:"ttft"}),e.jsx(re,{performance:c||[],title:"Success Rate by Model",metric:"success"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>t(!n),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Model Performance Comparison"}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:n?e.jsx(L,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),n&&e.jsx(it,{performance:c||[]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(ct,{categories:x||[]}),e.jsx(lt,{runs:o||[]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>s(!i),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Test Prompts Overview"})]}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:i?e.jsx(L,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),i&&e.jsx(ut,{runId:p?.run_id})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>r(!a),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Detailed Test Results"}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:a?e.jsx(L,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),a&&e.jsx(mt,{runId:p?.run_id})]})]})]})}function ht(){return h.useEffect(()=>{const a=document.getElementById("benchmark-container");if(a&&!a.querySelector("iframe")){const r=document.createElement("iframe"),i="/agentx-benchmark-ui/";r.src=`${i}jsonic-bench/index.html`,r.style.width="100%",r.style.height="100%",r.style.border="none",r.title="JSONIC Benchmarks",a.appendChild(r)}return()=>{const r=document.getElementById("benchmark-container");r&&(r.innerHTML="")}},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[e.jsx("header",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(ae,{to:"/",className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[e.jsx(Pe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Back to Dashboard"})]}),e.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-6 w-6 text-purple-600"}),e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"JSONIC Performance Benchmarks"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Compare storage solutions"})]})]})})}),e.jsx("div",{id:"benchmark-container",className:"w-full",style:{height:"calc(100vh - 64px)"}})]})}function pt({phase:a,current:r,total:i,message:s,percentage:n,onComplete:t}){const[o,l]=h.useState(!0),[c,g]=h.useState(!1);if(h.useEffect(()=>{if(a==="complete"){const x=setTimeout(()=>{g(!0),setTimeout(()=>{l(!1),t?.()},300)},500);return()=>clearTimeout(x)}},[a,t]),!o||a==="idle")return null;const d=()=>{switch(a){case"checking":case"loading":case"migrating":return e.jsx(Ee,{className:"h-8 w-8 animate-spin text-primary-600"});case"complete":return e.jsx(O,{className:"h-8 w-8 text-green-500"});case"error":return e.jsx(V,{className:"h-8 w-8 text-red-500"});default:return e.jsx(Le,{className:"h-8 w-8 text-gray-400"})}},u=()=>{switch(a){case"complete":return"bg-green-500";case"error":return"bg-red-500";default:return"bg-primary-600"}};return e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-gray-900/50 backdrop-blur-sm transition-opacity duration-300 ${c?"opacity-0":"opacity-100"}`,children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:d()}),e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[a==="checking"&&"Initializing Database",a==="loading"&&"Loading Data",a==="migrating"&&"Processing Documents",a==="complete"&&"Ready!",a==="error"&&"Error"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:s}),a!=="error"&&e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1",children:[e.jsx("span",{children:a==="migrating"?`${r} / ${i} documents`:""}),e.jsxs("span",{children:[Math.round(n),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-300 ease-out ${u()}`,style:{width:`${n}%`}})})]}),a==="migrating"&&i>0&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500 space-y-1",children:[e.jsxs("div",{children:["Processing at ~",Math.round(r/(n/100)/10)*10," docs/sec"]}),n>0&&n<100&&e.jsxs("div",{children:["Est. time remaining: ",Math.ceil((i-r)/(r/(n/20))),"s"]})]}),a==="error"&&e.jsx("div",{className:"w-full p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("p",{className:"text-xs text-red-700 dark:text-red-400 font-mono",children:s})})]})})})}async function ft(a){try{console.log("üöÄ Starting optimized batch migration..."),a?.({phase:"loading",current:0,total:100,message:"Initializing database...",percentage:5}),await k.initialize();const r=await k.getStats();if(r&&r.document_count>0)return console.log(`Database already contains ${r.document_count} documents, skipping migration`),a?.({phase:"complete",current:r.document_count,total:r.document_count,message:`Database ready with ${r.document_count} documents`,percentage:100}),!0;a?.({phase:"loading",current:0,total:100,message:"Loading data...",percentage:10});const s=await fetch("/agentx-benchmark-ui/data/database.json");if(!s.ok)throw new Error(`Failed to fetch database: ${s.status}`);const n=await s.json(),t=(n.benchmark_runs?.length||0)+(n.model_performance?.length||0)+(n.test_results?.length||0)+(n.performance_trends?.length||0);console.log(`Loading ${t} documents into JSONIC using batch insert...`);let o=0;const l=(d,u,x)=>({_type:d,_runId:x,_timestamp:new Date().toISOString(),...u}),c=await k.getDatabase();if(n.benchmark_runs&&n.benchmark_runs.length>0){a?.({phase:"migrating",current:o,total:t,message:"Batch loading benchmark runs...",percentage:20});const d=n.benchmark_runs.map(u=>l("benchmark_run",u));if(c.insert_many){const u=await c.insert_many(JSON.stringify(d)),x=typeof u=="string"?JSON.parse(u):u;(x.success||x.data)&&(o+=d.length,console.log(`Batch loaded ${d.length} benchmark runs`))}else{const u=d.map(x=>k.insert(x));await Promise.all(u),o+=d.length,console.log(`Loaded ${d.length} benchmark runs in parallel`)}}if(n.model_performance&&n.model_performance.length>0){a?.({phase:"migrating",current:o,total:t,message:"Batch loading model performance...",percentage:40});const d=n.model_performance.map(u=>l("model_performance",u,u.run_id));if(c.insert_many){const u=await c.insert_many(JSON.stringify(d)),x=typeof u=="string"?JSON.parse(u):u;(x.success||x.data)&&(o+=d.length,console.log(`Batch loaded ${d.length} model performance records`))}else{const u=d.map(x=>k.insert(x));await Promise.all(u),o+=d.length,console.log(`Loaded ${d.length} model performance records in parallel`)}}if(n.test_results&&n.test_results.length>0){a?.({phase:"migrating",current:o,total:t,message:"Batch loading test results...",percentage:60});const d=n.test_results.map(x=>l("test_result",x,x.run_id)),u=100;for(let x=0;x<d.length;x+=u){const p=d.slice(x,Math.min(x+u,d.length));if(c.insert_many){const b=await c.insert_many(JSON.stringify(p)),f=typeof b=="string"?JSON.parse(b):b;(f.success||f.data)&&(o+=p.length)}else{const b=p.map(f=>k.insert(f));await Promise.all(b),o+=p.length}const y=60+(o-n.benchmark_runs.length-n.model_performance.length)/n.test_results.length*25;a?.({phase:"migrating",current:o,total:t,message:`Processing test results... (${o}/${t})`,percentage:y})}console.log(`Batch loaded ${d.length} test results`)}if(n.performance_trends&&n.performance_trends.length>0){a?.({phase:"migrating",current:o,total:t,message:"Batch loading performance trends...",percentage:85});const d=n.performance_trends.map(u=>l("performance_trend",u));if(c.insert_many){const u=await c.insert_many(JSON.stringify(d)),x=typeof u=="string"?JSON.parse(u):u;(x.success||x.data)&&(o+=d.length,console.log(`Batch loaded ${d.length} performance trends`))}else{const u=d.map(x=>k.insert(x));await Promise.all(u),o+=d.length,console.log(`Loaded ${d.length} performance trends in parallel`)}}const g=await k.getStats();return console.log("Migration complete. Final stats:",g),a?.({phase:"complete",current:t,total:t,message:`‚úÖ Migration complete! ${t} documents loaded.`,percentage:100}),!0}catch(r){return console.error("Migration failed:",r),a?.({phase:"error",current:0,total:100,message:r instanceof Error?r.message:"Migration failed",percentage:0}),!1}}function yt(){const[a,r]=h.useState({phase:"idle",current:0,total:0,message:"",percentage:0}),[i,s]=h.useState(!1),[n,t]=h.useState(window.location.pathname);return h.useEffect(()=>{(async()=>{const c=window.location.pathname;if(t(c),c.includes("/jsonic-bench")){s(!0);return}try{Ge(d=>{console.log("Worker migration progress:",d),r(d),d.phase==="complete"?setTimeout(()=>{s(!0)},500):d.phase==="error"&&console.error("Worker migration error:",d.message)}),r({phase:"checking",current:0,total:100,message:"Initializing database...",percentage:0}),console.log("üöÄ Starting database migration..."),await ft(d=>{console.log("Migration progress:",d),r(d),d.phase==="complete"?setTimeout(()=>{s(!0)},500):d.phase==="error"&&console.error("Migration error:",d.message)})?console.log("‚úÖ Database migration completed successfully"):(console.error("‚ùå Database migration failed"),r({phase:"error",current:0,total:100,message:"Database initialization failed",percentage:0}))}catch(g){console.error("‚ùå Failed to initialize database:",g),r({phase:"error",current:0,total:100,message:"Database initialization failed",percentage:0})}})()},[]),e.jsx(Be,{children:e.jsxs(fe,{basename:"/agentx-benchmark-ui/",children:[!i&&!n.includes("/jsonic-bench")&&e.jsx(pt,{...a,onComplete:()=>s(!0)}),e.jsxs(ye,{children:[e.jsx(te,{path:"/",element:i?e.jsx(xt,{}):null}),e.jsx(te,{path:"/jsonic-bench",element:e.jsx(ht,{})})]})]})})}function bt(){return e.jsxs(e.Fragment,{children:[e.jsx(yt,{}),!1]})}be.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(bt,{})}));
//# sourceMappingURL=index-Dffhe1TD.js.map
