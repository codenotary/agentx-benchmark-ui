import{t as de,c as me,j as e,M as ge,T as q,a as X,R as Z,B as xe,C as ue,X as he,Y as pe,b as ee,d as L,P as fe,e as ye,f as be,g as je,h as ke,i as D,k as K,l as G,m as we,r as h,n as F,o as E,F as I,p as _e,H as te,u as T,q as z,s as Ne,A,Z as U,L as se,D as ve,v as Ce,w as Se,x as Ie,Q as Re,y as Te,z as De,E as $e,G as V,I as Oe,J as Me}from"./vendor.B4-PJLqz.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();class S{static instance;db=null;collection=null;initPromise=null;jsonicModule=null;constructor(){}static getInstance(){return S.instance||(S.instance=new S),S.instance}async initialize(){if(!this.db)return this.initPromise||(this.initPromise=this.performInitialization()),this.initPromise}async performInitialization(){const t=performance.now();console.log("[JSONIC v3.3] Starting initialization..."),console.log("[JSONIC] Environment:",{isDev:!1,baseUrl:"/agentx-benchmark-ui/",mode:"production",location:typeof window<"u"?window.location.href:"worker"});try{const i="/agentx-benchmark-ui/",r=typeof window>"u"&&typeof self<"u";let n;r?n=`${i}jsonic-worker-wrapper.js`:n=`${i}jsonic-wrapper-v3.esm.js`,console.log("[JSONIC] Loading wrapper from:",n);const o=(await import(n)).default;if(!o)throw new Error("JSONIC module not found");const d=performance.now();this.db=await o.createDatabase({name:"agentx_benchmark",persistence:!1,enablePersistence:!1}),console.log(`[JSONIC] Database created in ${(performance.now()-d).toFixed(2)}ms`),console.log("[JSONIC v3.3] Initialized successfully");const l=performance.now()-t;console.log(`[JSONIC] Total initialization time: ${l.toFixed(2)}ms`),l>1e3&&console.warn(`[JSONIC] âš ï¸ Slow initialization: ${l.toFixed(2)}ms`)}catch(i){throw console.error("[JSONIC] Failed to initialize:",i),console.error(`[JSONIC] Failed after ${(performance.now()-t).toFixed(2)}ms`),i}}async getDatabase(){if(this.db||await this.initialize(),!this.db)throw new Error("JSONIC database not initialized");return this.db}async getCollection(){return await this.getDatabase()}async insert(t){return await(await this.getDatabase()).insert(t)}async get(t){return(await this.getCollection()).findOne({_id:t})}async update(t,i){await(await this.getCollection()).updateOne({_id:t},{$set:i})}async delete(t){await(await this.getCollection()).deleteOne({_id:t})}async listIds(){return(await(await this.getCollection()).find({},{projection:{_id:1}})).map(r=>r._id)}async getStats(){return{documentCount:await this.count(),collectionName:"benchmarks"}}async query(t){return(await(await this.getCollection()).find({})).filter(t)}async findDocuments(t,i){const r=await this.getDatabase();console.log("[JSONIC-SERVICE] findDocuments called with filter:",t,"options:",i);const n=await r.list();if(console.log("[JSONIC-SERVICE] Total IDs in database:",n.length),n.length>0){const o=await r.get(n[0]);console.log("[JSONIC-SERVICE] First document from DB:",o),console.log("[JSONIC-SERVICE] First document keys:",o?Object.keys(o):"null")}const s=await r.query(t,i);return console.log("[JSONIC-SERVICE] findDocuments returned:",s.length,"documents"),s.length>0&&console.log("[JSONIC-SERVICE] First result:",s[0]),s}async findOne(t){return(await this.getDatabase()).findOne(t)}async find(t={},i){return(await this.getDatabase()).query(t,i)}async insertMany(t){return await(await this.getDatabase()).insertMany(t)}async updateMany(t,i){return(await this.getCollection()).updateMany(t,i)}async deleteMany(t){return(await this.getCollection()).deleteMany(t)}async aggregate(t){return(await this.getCollection()).aggregate(t)}async count(t={}){return(await(await this.getDatabase()).query(t)).length}async getBenchmarkStats(t){const i=[];return t&&i.push({$match:{testId:t}}),i.push({$group:{_id:"$testId",avgDuration:{$avg:"$duration"},minDuration:{$min:"$duration"},maxDuration:{$max:"$duration"},totalRuns:{$sum:1},successCount:{$sum:{$cond:[{$eq:["$status","success"]},1,0]}},failureCount:{$sum:{$cond:[{$eq:["$status","failure"]},1,0]}}}},{$sort:{totalRuns:-1}}),this.aggregate(i)}}const j=S.getInstance();async function P(){return(await j.findDocuments({_type:"benchmark_run"},{sort:{timestamp:-1}})).map(i=>{const{id:r,_type:n,_runId:s,_timestamp:o,...d}=i;return d})}async function Fe(a){let t=a;{const s=await P();s.length>0&&(t=s[0].run_id)}const r=(await j.findDocuments({_type:"model_performance",_runId:t},{sort:{provider:1,model:1}})).map(s=>{const{id:o,_type:d,_runId:l,_timestamp:g,...m}=s;return m}),n=new Map;return r.forEach(s=>{const o=`${s.provider}-${s.model}`,d=n.get(o);d?n.set(o,{...d,total_tests:d.total_tests+s.total_tests,successful_tests:d.successful_tests+s.successful_tests,failed_tests:d.failed_tests+s.failed_tests,avg_ttft_ms:(d.avg_ttft_ms+s.avg_ttft_ms)/2,min_ttft_ms:Math.min(d.min_ttft_ms,s.min_ttft_ms),max_ttft_ms:Math.max(d.max_ttft_ms,s.max_ttft_ms),avg_total_time_ms:(d.avg_total_time_ms+s.avg_total_time_ms)/2,total_tokens_generated:d.total_tokens_generated+s.total_tokens_generated,avg_tokens_per_second:(d.avg_tokens_per_second+s.avg_tokens_per_second)/2,avg_quality_score:(d.avg_quality_score+s.avg_quality_score)/2,cost_per_1k_tokens:s.cost_per_1k_tokens,success_rate:(d.successful_tests+s.successful_tests)/(d.total_tests+s.total_tests)*100}):n.set(o,s)}),Array.from(n.values())}async function H(a){return(await j.findDocuments({_type:"test_result",_runId:a},{sort:{timestamp:-1},limit:500})).map(r=>{const{id:n,_type:s,_runId:o,_timestamp:d,...l}=r;return l})}async function Ee(){const a=new Date;a.setDate(a.getDate()-7);const t=a.toISOString();return(await j.findDocuments({_type:"performance_trend",recorded_at:{$gte:t}},{sort:{recorded_at:-1},limit:100})).map(n=>{const{id:s,_type:o,_runId:d,_timestamp:l,...g}=n;return g})}async function Ae(a){let t=a;{const s=await P();s.length>0&&(t=s[0].run_id)}if(!t)return[];const i=await H(t),r=new Map;i.forEach(s=>{const o=`${s.category}-${s.provider}-${s.model}`;r.has(o)||r.set(o,{category:s.category,provider:s.provider,model:s.model,avg_ttft_ms:0,avg_total_time_ms:0,total_tests:0,success_rate:0,_ttft_sum:0,_total_time_sum:0,_success_count:0,_test_count:0});const d=r.get(o);d._test_count++,d._ttft_sum+=s.time_to_first_token_ms||0,d._total_time_sum+=s.total_time_ms||0,s.success&&d._success_count++});const n=[];return r.forEach(s=>{const o=s;n.push({category:o.category,provider:o.provider,model:o.model,avg_ttft_ms:o._test_count>0?o._ttft_sum/o._test_count:0,avg_total_time_ms:o._test_count>0?o._total_time_sum/o._test_count:0,total_tests:o._test_count,success_rate:o._test_count>0?o._success_count/o._test_count*100:0})}),n}function Pe(a){return new Worker("/agentx-benchmark-ui/assets/migration.worker-Cy8et84E.js",{type:"module",name:a?.name})}let b=null;function Be(a){return console.log("[WORKER-MIGRATION] Starting worker migration check..."),console.log("[WORKER-MIGRATION] Browser info:",{userAgent:navigator.userAgent,platform:navigator.platform,vendor:navigator.vendor,language:navigator.language}),new Promise((t,i)=>{if(typeof window>"u")return console.error("[WORKER-MIGRATION] Worker migration only available in browser"),t(!1);b&&(console.log("Worker already running, terminating..."),b.terminate(),b=null);try{console.log("[WORKER-MIGRATION] ðŸš€ Creating JSONIC migration worker..."),console.log("[WORKER-MIGRATION] Current URL:",window.location.href),console.log("[WORKER-MIGRATION] Base URL:","/agentx-benchmark-ui/"),b=new Pe,console.log("[WORKER-MIGRATION] Worker created successfully"),b.onmessage=r=>{console.log("[WORKER-MIGRATION] Message from worker:",r.data.type,r.data),r.data.type==="progress"?a?.(r.data.payload):r.data.type==="migrationComplete"&&(r.data.payload?(console.log("âœ… Worker migration completed successfully"),t(!0)):(console.error("âŒ Worker migration failed"),i(new Error("Migration failed in worker"))),b?.terminate(),b=null)},b.onerror=r=>{console.error("âŒ Worker error:",r),a?.({phase:"error",message:"Worker failed to initialize",percentage:0,current:0,total:0}),i(new Error(`Worker error: ${r.message||"Unknown error"}`)),b?.terminate(),b=null},b.onmessageerror=r=>{console.error("âŒ Worker message error:",r),a?.({phase:"error",message:"Worker communication error",percentage:0,current:0,total:0}),i(new Error("Worker communication error")),b?.terminate(),b=null},console.log("ðŸ“¤ Starting worker migration..."),b.postMessage({type:"startMigration"})}catch(r){console.error("âŒ Failed to create worker:",r),a?.({phase:"error",message:"Failed to create worker",percentage:0,current:0,total:0}),i(r)}})}let Q=!1,W=null,re;function Je(a){re=a}async function $(){if(Q)return;W||(W=(async()=>{try{await j.initialize();const t=await j.getStats();if(t&&t.documentCount>0)return console.log(`[API-JSONIC] Database already initialized with ${t.documentCount} documents, skipping worker migration`),!0}catch(t){console.warn("[API-JSONIC] Failed to check existing data:",t)}return Be(re)})()),await W&&(Q=!0)}async function Le(){console.log("[API-JSONIC] fetchBenchmarkRuns called");try{await $(),console.log("[API-JSONIC] Fetching benchmark runs from JSONIC...");const a=await P();return console.log(`[API-JSONIC] Fetched ${a.length} benchmark runs`),a}catch(a){throw console.error("Failed to fetch benchmark runs from JSONIC:",a),a}}async function We(a){try{return await $(),await Fe(a)}catch(t){throw console.error("Failed to fetch model performance from JSONIC:",t),t}}async function ae(a){try{return await $(),await H(a)}catch(t){throw console.error("Failed to fetch test results from JSONIC:",t),t}}async function qe(){try{return await $(),await Ee()}catch(a){throw console.error("Failed to fetch performance trends from JSONIC:",a),a}}async function ze(a){try{return await $(),await Ae(a)}catch(t){throw console.error("Failed to fetch category performance from JSONIC:",t),t}}const Ke=window.location.hostname==="localhost"?"http://localhost:3001/api":`${window.location.protocol}//${window.location.hostname}:3001/api`;console.log("=== Database Configuration ===");console.log("API_BASE:",Ke);console.log("Current hostname:",window.location.hostname);console.log("Using JSONIC database");console.log("==============================");async function Ge(){return console.log("Fetching benchmark runs from JSONIC"),await Le()}async function Ue(a){return console.log("Fetching model performance from JSONIC"),await We(a)}async function He(a){return console.log("Fetching test results from JSONIC"),await ae(a)}async function Ve(){return console.log("Fetching performance trends from JSONIC"),await qe()}async function Qe(a){return console.log("Fetching category performance from JSONIC"),await ze(a)}function N(...a){return de(me(a))}function v(a){return a<1e3?`${a.toFixed(0)}ms`:`${(a/1e3).toFixed(2)}s`}function ne(a){return a<.01?`$${(a*1e3).toFixed(2)}/1K`:`$${a.toFixed(4)}`}function R(a){return`${a.toFixed(1)}%`}function oe(a){return a<1e3?a.toString():`${(a/1e3).toFixed(1)}K`}function M({title:a,value:t,icon:i,trend:r=0,format:n,invertTrend:s=!1}){const o=()=>{switch(n){case"percentage":return R(t);case"duration":return v(t);case"currency":return ne(t);default:return t.toLocaleString()}},d=()=>Math.abs(r)<.5?e.jsx(ge,{className:"h-4 w-4"}):r>0?e.jsx(q,{className:"h-4 w-4"}):e.jsx(X,{className:"h-4 w-4"}),l=()=>{if(Math.abs(r)<.5)return"text-gray-500";const g=r>0;return(s?!g:g)?"text-success-500":"text-error-500"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:i})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o()}),r!==0&&e.jsxs("div",{className:N("flex items-center text-sm",l()),children:[d(),e.jsxs("span",{className:"ml-1",children:[Math.abs(r).toFixed(1),"%"]})]})]})]})}function Y({performance:a,title:t,metric:i}){const r=a.map(o=>{const d=o.model.replace(/-\d{8}$/,"").replace("claude-3-5-","Claude ").replace("gemini-","Gemini ");switch(i){case"ttft":return{model:d,value:o.avg_ttft_ms,min:o.min_ttft_ms,max:o.max_ttft_ms};case"throughput":return{model:d,value:o.avg_tokens_per_second};case"success":return{model:d,value:o.success_rate};case"cost":return{model:d,value:o.cost_per_1k_tokens*1e3};default:return{model:d,value:0}}}),n=o=>{switch(i){case"ttft":case"throughput":return v(o);case"success":return R(o);case"cost":return`$${o.toFixed(3)}`;default:return o.toFixed(2)}},s=()=>{switch(i){case"ttft":return"Time (ms)";case"throughput":return"Tokens/sec";case"success":return"Success Rate (%)";case"cost":return"Cost ($/1K tokens)";default:return""}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),e.jsx(Z,{width:"100%",height:300,children:e.jsxs(xe,{data:r,margin:{top:10,right:30,left:0,bottom:40},children:[e.jsx(ue,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(he,{dataKey:"model",angle:-45,textAnchor:"end",height:100,className:"text-xs",tick:{fill:"#9ca3af"}}),e.jsx(pe,{label:{value:s(),angle:-90,position:"insideLeft",style:{fill:"#9ca3af",fontSize:12}},tick:{fill:"#9ca3af"}}),e.jsx(ee,{formatter:n,contentStyle:{backgroundColor:"rgba(31, 41, 55, 0.95)",border:"1px solid rgba(75, 85, 99, 0.3)",borderRadius:"6px"},labelStyle:{color:"#d1d5db"}}),e.jsx(L,{dataKey:"value",fill:"#3b82f6",radius:[4,4,0,0]}),i==="ttft"&&e.jsxs(e.Fragment,{children:[e.jsx(L,{dataKey:"min",fill:"#10b981",radius:[4,4,0,0],opacity:.5}),e.jsx(L,{dataKey:"max",fill:"#ef4444",radius:[4,4,0,0],opacity:.5})]})]})})]})}function Ye({performance:a}){const t=[...a].sort((r,n)=>n.success_rate-r.success_rate),i=r=>r>=95?"bg-success-50 text-success-700":r>=80?"bg-warning-50 text-warning-700":"bg-error-50 text-error-700";return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Model"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Success Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Avg TTFT"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Throughput"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Tokens"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cost/1K"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Quality"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.model.replace(/-\d{8}$/,"")}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.provider})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:N("inline-flex px-2 py-1 text-xs font-semibold rounded-full",i(r.success_rate)),children:R(r.success_rate)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:v(r.avg_ttft_ms)}),e.jsxs("span",{className:"text-xs text-gray-500",children:[v(r.min_ttft_ms)," - ",v(r.max_ttft_ms)]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:[r.avg_tokens_per_second.toFixed(1)," tok/s"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:oe(r.total_tokens_generated)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("span",{className:N("font-medium",r.cost_per_1k_tokens<.002?"text-success-600":r.cost_per_1k_tokens<.005?"text-warning-600":"text-error-600"),children:["$",(r.cost_per_1k_tokens*1e3).toFixed(3)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.avg_quality_score>0?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 w-16",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full",style:{width:`${r.avg_quality_score*100}%`}})}),e.jsxs("span",{className:"ml-2 text-xs text-gray-600 dark:text-gray-400",children:[(r.avg_quality_score*100).toFixed(0),"%"]})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"N/A"})})]},`${r.provider}-${r.model}`))})]})})}function Xe({categories:a}){const t=a.reduce((s,o)=>(s[o.category]||(s[o.category]={category:o.category,avgTTFT:0,avgSuccessRate:0,totalTests:0,count:0}),s[o.category].avgTTFT+=o.avg_ttft_ms,s[o.category].avgSuccessRate+=o.success_rate,s[o.category].totalTests+=o.total_tests,s[o.category].count++,s),{}),i=Object.values(t).map(s=>({name:s.category.charAt(0).toUpperCase()+s.category.slice(1),value:s.totalTests,avgTTFT:s.avgTTFT/s.count,successRate:s.avgSuccessRate/s.count})),r=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"],n=({active:s,payload:o})=>{if(s&&o&&o[0]){const d=o[0].payload;return e.jsxs("div",{className:"bg-gray-900 text-white p-3 rounded-lg shadow-lg border border-gray-700",children:[e.jsx("p",{className:"font-semibold",children:d.name}),e.jsxs("p",{className:"text-sm",children:["Tests: ",d.value]}),e.jsxs("p",{className:"text-sm",children:["Avg TTFT: ",v(d.avgTTFT)]}),e.jsxs("p",{className:"text-sm",children:["Success: ",R(d.successRate)]})]})}return null};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Performance by Category"}),e.jsx(Z,{width:"100%",height:300,children:e.jsxs(fe,{children:[e.jsx(ye,{data:i,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:o})=>`${s}: ${(o*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:i.map((s,o)=>e.jsx(be,{fill:r[o%r.length]},`cell-${o}`))}),e.jsx(ee,{content:e.jsx(n,{})})]})}),e.jsx("div",{className:"mt-4 space-y-2",children:i.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:r[o%r.length]}}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.name})]}),e.jsxs("div",{className:"text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:s.value})," tests â€¢",e.jsx("span",{className:"ml-1",children:R(s.successRate)})]})]},s.name))})]})}function Ze({runs:a}){const t=r=>{const n=r.successful_runs/r.total_runs*100;return n>=95?e.jsx(D,{className:"h-5 w-5 text-success-500"}):n>=80?e.jsx(K,{className:"h-5 w-5 text-warning-500"}):e.jsx(G,{className:"h-5 w-5 text-error-500"})},i=r=>{const n=r.successful_runs/r.total_runs*100;return n>=95?"border-success-200 bg-success-50":n>=80?"border-warning-200 bg-warning-50":"border-error-200 bg-error-50"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Benchmark Runs"}),e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((r,n)=>e.jsxs("div",{className:N("flex items-center justify-between p-3 rounded-lg border transition-colors hover:shadow-md cursor-pointer",n===0?i(r):"border-gray-200 dark:border-gray-700 hover:border-primary-300"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[t(r),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.name||`Benchmark #${r.id}`}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:je(new Date(r.timestamp),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[r.successful_runs,"/",r.total_runs]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[R(r.successful_runs/r.total_runs*100)," success"]})]}),e.jsx(ke,{className:"h-5 w-5 text-gray-400"})]})]},r.id))}),a.length>5&&e.jsxs("button",{className:"mt-4 w-full py-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:["View all ",a.length," runs â†’"]})]})}function et({trends:a}){const t=a.filter(n=>n.is_regression),i=a.filter(n=>!n.is_regression&&n.change_percentage&&n.change_percentage<-10);if(t.length===0&&i.length===0)return null;const r=(n,s)=>`${n}/${s.replace(/-\d{8}$/,"")}`;return e.jsxs("div",{className:"space-y-4",children:[t.length>0&&e.jsx("div",{className:"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(we,{className:"h-5 w-5 text-error-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-error-800 dark:text-error-200 mb-2",children:"Performance Regressions Detected"}),e.jsx("div",{className:"space-y-1",children:t.slice(0,3).map((n,s)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-error-700 dark:text-error-300",children:[r(n.provider,n.model)," - ",n.metric_name]}),e.jsxs("span",{className:"font-medium text-error-800 dark:text-error-200",children:[e.jsx(X,{className:"inline h-4 w-4 mr-1"}),Math.abs(n.change_percentage||0).toFixed(1),"% slower"]})]},s))})]})]})}),i.length>0&&e.jsx("div",{className:"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(q,{className:"h-5 w-5 text-success-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-success-800 dark:text-success-200 mb-2",children:"Performance Improvements"}),e.jsx("div",{className:"space-y-1",children:i.slice(0,3).map((n,s)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-success-700 dark:text-success-300",children:[r(n.provider,n.model)," - ",n.metric_name]}),e.jsxs("span",{className:"font-medium text-success-800 dark:text-success-200",children:[e.jsx(q,{className:"inline h-4 w-4 mr-1"}),Math.abs(n.change_percentage||0).toFixed(1),"% faster"]})]},s))})]})]})})]})}function tt({runId:a}){const[t,i]=h.useState([]),[r,n]=h.useState(!0),[s,o]=h.useState(new Set),[d,l]=h.useState("all"),[g,m]=h.useState("time"),[x,u]=h.useState("desc");h.useEffect(()=>{_()},[a]);const _=async()=>{try{n(!0);let c;if(a)c=await ae(a);else{const p=await P();if(p&&p.length>0){const ie=p.sort((ce,le)=>new Date(le.timestamp).getTime()-new Date(ce.timestamp).getTime())[0].run_id;c=await H(ie)}else c=[]}i(c)}catch(c){console.error("Error fetching test results:",c),i(st())}finally{n(!1)}},C=c=>{const p=new Set(s);p.has(c)?p.delete(c):p.add(c),o(p)},k=[...t.filter(c=>d==="all"?!0:d==="success"?c.success:d==="failed"?!c.success:c.category===d)].sort((c,p)=>{let w=0;switch(g){case"time":w=c.total_time_ms-p.total_time_ms;break;case"tokens":w=c.tokens_generated-p.tokens_generated;break;case"category":w=c.category.localeCompare(p.category);break;case"status":w=(c.success?1:0)-(p.success?1:0);break}return x==="asc"?w:-w}),O=[...new Set(t.map(c=>c.category))],B=c=>c?e.jsx(D,{className:"h-5 w-5 text-success-500"}):e.jsx(G,{className:"h-5 w-5 text-error-500"}),J=c=>({math:e.jsx(te,{className:"h-4 w-4"}),coding:e.jsx(_e,{className:"h-4 w-4"}),technical:e.jsx(I,{className:"h-4 w-4"}),reasoning:e.jsx(K,{className:"h-4 w-4"})})[c]||e.jsx(I,{className:"h-4 w-4"}),y=c=>({math:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",coding:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",technical:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",reasoning:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",creative:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",mcp_tools:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300"})[c]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300";return r?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading test results..."})]})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Detailed Test Results (",k.length," tests)"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>l("all"),className:N("px-3 py-1 rounded-md text-sm font-medium transition-colors",d==="all"?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["All (",t.length,")"]}),e.jsxs("button",{onClick:()=>l("success"),className:N("px-3 py-1 rounded-md text-sm font-medium transition-colors",d==="success"?"bg-success-100 text-success-700 dark:bg-success-900 dark:text-success-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["Success (",t.filter(c=>c.success).length,")"]}),e.jsxs("button",{onClick:()=>l("failed"),className:N("px-3 py-1 rounded-md text-sm font-medium transition-colors",d==="failed"?"bg-error-100 text-error-700 dark:bg-error-900 dark:text-error-300":"text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"),children:["Failed (",t.filter(c=>!c.success).length,")"]})]}),e.jsxs("select",{value:d,onChange:c=>l(c.target.value),className:"px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:"all",children:"All Categories"}),O.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsxs("select",{value:`${g}-${x}`,onChange:c=>{const[p,w]=c.target.value.split("-");m(p),u(w)},className:"px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:"time-desc",children:"Slowest First"}),e.jsx("option",{value:"time-asc",children:"Fastest First"}),e.jsx("option",{value:"tokens-desc",children:"Most Tokens"}),e.jsx("option",{value:"tokens-asc",children:"Least Tokens"}),e.jsx("option",{value:"category-asc",children:"Category A-Z"}),e.jsx("option",{value:"status-desc",children:"Success First"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Model"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Prompt"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"TTFT"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tokens"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Cost"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:k.map(c=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:B(c.success)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.model.replace(/-\d{8}$/,"")}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[c.provider," â€¢ Iteration ",c.iteration]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:N("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",y(c.category)),children:[J(c.category),e.jsx("span",{className:"ml-1",children:c.category})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs truncate text-sm text-gray-900 dark:text-gray-300",children:c.prompt_text||c.prompt_id})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:v(c.time_to_first_token_ms)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:v(c.total_time_ms)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:e.jsxs("div",{children:[e.jsx("div",{children:oe(c.tokens_generated)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[c.tokens_per_second?.toFixed(1)," tok/s"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:ne(c.estimated_cost_usd)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>C(c.id),className:"text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:s.has(c.id)?e.jsx(F,{className:"h-5 w-5"}):e.jsx(E,{className:"h-5 w-5"})})})]},c.id),s.has(c.id)&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Full Prompt:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("pre",{className:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:c.prompt_text})})]}),c.response&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Response:"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:e.jsx("pre",{className:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:c.response})})]}),c.error_message&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-error-700 dark:text-error-300 mb-2",children:"Error:"}),e.jsx("div",{className:"bg-error-50 dark:bg-error-900/20 p-3 rounded-md border border-error-200 dark:border-error-800",children:e.jsx("pre",{className:"text-sm text-error-800 dark:text-error-200 whitespace-pre-wrap",children:c.error_message})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Timestamp:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-gray-200",children:new Date(c.timestamp).toLocaleString()})]}),c.quality_score&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Quality Score:"}),e.jsxs("span",{className:"ml-2 text-gray-900 dark:text-gray-200",children:[(c.quality_score*100).toFixed(1),"%"]})]})]})]})})})]}))})]})}),k.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No test results found for the selected filter."})]})}function st(){const a=["math","coding","reasoning","technical","creative","mcp_tools"],t={math:"Calculate the factorial of 12",coding:"Write a Python function to reverse a linked list",reasoning:"If all birds can fly and penguins are birds, can penguins fly?",technical:"Explain the difference between TCP and UDP protocols",creative:"Write a haiku about machine learning",mcp_tools:"List all virtual machines with more than 16GB RAM"};return Array.from({length:20},(i,r)=>{const n=a[r%a.length],s=Math.random()>.15;return{id:r+1,run_id:`bench-${Date.now()}`,timestamp:new Date(Date.now()-Math.random()*864e5).toISOString(),provider:["anthropic","gemini","ollama"][r%3],model:["claude-3-5-haiku-20241022","gemini-2.0-flash-exp","llama2"][r%3],prompt_id:`${n}_test`,prompt_text:t[n],category:n,iteration:r%3+1,time_to_first_token_ms:500+Math.random()*3e3,total_time_ms:1e3+Math.random()*5e3,tokens_generated:50+Math.floor(Math.random()*500),tokens_per_second:20+Math.random()*30,quality_score:s?.7+Math.random()*.3:void 0,success:s,error_message:s?void 0:"Rate limit exceeded",response:s?`This is a sample response for ${n} prompt...`:void 0,estimated_cost_usd:Math.random()*.01}})}function rt({runId:a}){const[t,i]=h.useState(null),{data:r,isLoading:n}=T({queryKey:["testResults",a],queryFn:()=>a?He(a):Promise.resolve([]),enabled:!!a}),s=[];if(r){const l=new Map;r.forEach(g=>{const m=g.prompt_id;l.has(m)||l.set(m,{prompt_id:g.prompt_id,prompt_text:g.prompt_text,category:g.category,total_tests:0,successful_tests:0,failed_tests:0,avg_time_ms:0,avg_tokens:0,providers:[]});const x=l.get(m);x.total_tests++,g.success?x.successful_tests++:x.failed_tests++,x.avg_time_ms+=g.total_time_ms||0,x.avg_tokens+=g.tokens_generated||0;const u=`${g.provider}/${g.model}`;x.providers.includes(u)||x.providers.push(u)}),l.forEach(g=>{g.avg_time_ms=g.avg_time_ms/g.total_tests,g.avg_tokens=Math.round(g.avg_tokens/g.total_tests)}),s.push(...Array.from(l.values()))}const o=l=>({math:e.jsx(te,{className:"h-4 w-4"}),coding:e.jsx(I,{className:"h-4 w-4"}),reasoning:e.jsx(U,{className:"h-4 w-4"}),technical:e.jsx(A,{className:"h-4 w-4"}),creative:e.jsx(I,{className:"h-4 w-4"}),mcp_tools:e.jsx(Ne,{className:"h-4 w-4"})})[l]||e.jsx(I,{className:"h-4 w-4"}),d=l=>({math:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",coding:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",reasoning:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",technical:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",creative:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",mcp_tools:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200"})[l]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";return n?e.jsxs("div",{className:"animate-pulse space-y-3 p-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"})]}):s.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No test prompts found for this run"})]}):e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:s.length})," unique prompts tested across ",e.jsx("strong",{children:s.reduce((l,g)=>l+g.providers.length,0)})," model configurations"]}),s.map(l=>{const g=l.successful_tests/l.total_tests*100,m=t===l.prompt_id;return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-4 cursor-pointer select-none",onClick:()=>i(m?null:l.prompt_id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${d(l.category)}`,children:[o(l.category),l.category]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",l.prompt_id]})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:l.prompt_text}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[g>=80?e.jsx(D,{className:"h-3 w-3 text-green-500"}):g>=50?e.jsx(z,{className:"h-3 w-3 text-yellow-500"}):e.jsx(G,{className:"h-3 w-3 text-red-500"}),g.toFixed(0),"% success"]}),e.jsxs("span",{children:[l.total_tests," runs"]}),e.jsxs("span",{children:[(l.avg_time_ms/1e3).toFixed(1),"s avg"]}),e.jsxs("span",{children:[l.avg_tokens," tokens avg"]})]})]}),e.jsx("div",{className:"ml-4 text-gray-400",children:e.jsx("svg",{className:`h-5 w-5 transform transition-transform ${m?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),m&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.jsx("strong",{children:"Full Prompt:"})}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-900 rounded text-sm text-gray-700 dark:text-gray-300 font-mono",children:l.prompt_text}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Test Results"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400",children:["âœ“ ",l.successful_tests," passed"]}),e.jsxs("span",{className:"text-sm text-red-600 dark:text-red-400",children:["âœ— ",l.failed_tests," failed"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Tested Models"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.providers.map(x=>e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded",children:x},x))})]})]})]})})]},l.prompt_id)})]})}function at(){h.useEffect(()=>{console.log("[DASHBOARD] Component mounted"),console.log("[DASHBOARD] Using API from:","../services/api")},[]);const[a,t]=h.useState(!1),[i,r]=h.useState(!0),[n,s]=h.useState(!0),{data:o,isLoading:d,error:l}=T({queryKey:["benchmarkRuns"],queryFn:()=>(console.log("[DASHBOARD] Fetching benchmark runs..."),Ge()),refetchInterval:6e4,onSuccess:y=>{console.log("[DASHBOARD] Benchmark runs loaded:",y?.length||0,"runs")},onError:y=>{console.error("[DASHBOARD] Failed to load benchmark runs:",y)}}),{data:g,isLoading:m,error:x}=T({queryKey:["modelPerformance"],queryFn:()=>(console.log("[DASHBOARD] Fetching model performance..."),Ue()),refetchInterval:6e4,onSuccess:y=>{console.log("[DASHBOARD] Model performance loaded:",y?.length||0,"records")},onError:y=>{console.error("[DASHBOARD] Failed to load model performance:",y)}}),{data:u,isLoading:_}=T({queryKey:["performanceTrends"],queryFn:Ve,refetchInterval:6e4}),{data:C}=T({queryKey:["categoryPerformance"],queryFn:()=>Qe(),refetchInterval:6e4}),f=o?.[0],k=f?.total_runs||0,O=f?f.successful_runs/f.total_runs*100:0,B=g?g.reduce((y,c)=>y+c.avg_ttft_ms,0)/g.length:0,J=g?g.reduce((y,c)=>y+c.total_cost_usd,0):0;return d||m?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading benchmark data..."}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg max-w-md",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Debug Info:"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Runs Loading: ",d?"Yes":"No"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Performance Loading: ",m?"Yes":"No"]}),l&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:["Error: ",String(l)]}),x&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:["Error: ",String(x)]})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"fixed bottom-4 right-4 p-3 bg-black bg-opacity-75 text-white rounded-lg text-xs max-w-sm z-50",children:[e.jsx("div",{className:"font-bold mb-2",children:"Debug Info"}),e.jsxs("div",{children:["Runs: ",o?.length||0]}),e.jsxs("div",{children:["Performance: ",g?.length||0]}),e.jsxs("div",{children:["Trends: ",u?.length||0]}),e.jsxs("div",{children:["Categories: ",C?.length||0]}),e.jsxs("div",{children:["Errors: ",l||x?"Yes":"No"]}),e.jsx("div",{className:"mt-2 text-yellow-300",children:"Check console for details"})]}),e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-primary-600 mr-3"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"AgentX Benchmark Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(se,{to:"/jsonic-bench",className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all shadow-md hover:shadow-lg",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"JSONIC Benchmarks"})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last updated: ",f?new Date(f.timestamp).toLocaleString():"Never"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(M,{title:"Total Tests",value:k,icon:e.jsx(A,{className:"h-5 w-5"}),trend:o&&o.length>1?(o[0].total_runs-o[1].total_runs)/o[1].total_runs*100:0,format:"number"}),e.jsx(M,{title:"Success Rate",value:O,icon:e.jsx(D,{className:"h-5 w-5"}),trend:o&&o.length>1?O-o[1].successful_runs/o[1].total_runs*100:0,format:"percentage",invertTrend:!1}),e.jsx(M,{title:"Avg TTFT",value:B,icon:e.jsx(K,{className:"h-5 w-5"}),trend:u&&u.find(y=>y.metric_name==="avg_ttft_ms")?.change_percentage||0,format:"duration",invertTrend:!0}),e.jsx(M,{title:"Total Cost",value:J,icon:e.jsx(ve,{className:"h-5 w-5"}),trend:0,format:"currency",invertTrend:!0})]}),u&&!_&&e.jsx("div",{className:"mb-8",children:e.jsx(et,{trends:u})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(Y,{performance:g||[],title:"Response Time by Model",metric:"ttft"}),e.jsx(Y,{performance:g||[],title:"Success Rate by Model",metric:"success"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>s(!n),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Model Performance Comparison"}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:n?e.jsx(F,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),n&&e.jsx(Ye,{performance:g||[]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(Xe,{categories:C||[]}),e.jsx(Ze,{runs:o||[]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>r(!i),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Test Prompts Overview"})]}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:i?e.jsx(F,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),i&&e.jsx(rt,{runId:f?.run_id})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",onClick:()=>t(!a),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Detailed Test Results"}),e.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:a?e.jsx(F,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(E,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),a&&e.jsx(tt,{runId:f?.run_id})]})]})]})}function nt(){return h.useEffect(()=>{const a=document.getElementById("benchmark-container");if(a&&!a.querySelector("iframe")){const t=document.createElement("iframe"),i="/agentx-benchmark-ui/";t.src=`${i}jsonic-bench/index.html`,t.style.width="100%",t.style.height="100%",t.style.border="none",t.title="JSONIC Benchmarks",a.appendChild(t)}return()=>{const t=document.getElementById("benchmark-container");t&&(t.innerHTML="")}},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[e.jsx("header",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(se,{to:"/",className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[e.jsx(Ce,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Back to Dashboard"})]}),e.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-6 w-6 text-purple-600"}),e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"JSONIC Performance Benchmarks"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Compare storage solutions"})]})]})})}),e.jsx("div",{id:"benchmark-container",className:"w-full",style:{height:"calc(100vh - 64px)"}})]})}function ot({phase:a,current:t,total:i,message:r,percentage:n,onComplete:s}){const[o,d]=h.useState(!0),[l,g]=h.useState(!1);if(h.useEffect(()=>{if(a==="complete"){const u=setTimeout(()=>{g(!0),setTimeout(()=>{d(!1),s?.()},300)},500);return()=>clearTimeout(u)}},[a,s]),!o||a==="idle")return null;const m=()=>{switch(a){case"checking":case"loading":case"migrating":return e.jsx(Ie,{className:"h-8 w-8 animate-spin text-primary-600"});case"complete":return e.jsx(D,{className:"h-8 w-8 text-green-500"});case"error":return e.jsx(z,{className:"h-8 w-8 text-red-500"});default:return e.jsx(Se,{className:"h-8 w-8 text-gray-400"})}},x=()=>{switch(a){case"complete":return"bg-green-500";case"error":return"bg-red-500";default:return"bg-primary-600"}};return e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-gray-900/50 backdrop-blur-sm transition-opacity duration-300 ${l?"opacity-0":"opacity-100"}`,children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:m()}),e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[a==="checking"&&"Initializing Database",a==="loading"&&"Loading Data",a==="migrating"&&"Processing Documents",a==="complete"&&"Ready!",a==="error"&&"Error"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:r}),a!=="error"&&e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1",children:[e.jsx("span",{children:a==="migrating"?`${t} / ${i} documents`:""}),e.jsxs("span",{children:[Math.round(n),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-300 ease-out ${x()}`,style:{width:`${n}%`}})})]}),a==="migrating"&&i>0&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500 space-y-1",children:[e.jsxs("div",{children:["Processing at ~",Math.round(t/(n/100)/10)*10," docs/sec"]}),n>0&&n<100&&e.jsxs("div",{children:["Est. time remaining: ",Math.ceil((i-t)/(t/(n/20))),"s"]})]}),a==="error"&&e.jsx("div",{className:"w-full p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("p",{className:"text-xs text-red-700 dark:text-red-400 font-mono",children:r})})]})})})}async function it(a){try{console.log("ðŸš€ Starting optimized batch migration..."),a?.({phase:"loading",current:0,total:100,message:"Initializing database...",percentage:5}),await j.initialize();const t=await j.getStats();if(t&&t.document_count>0)return console.log(`Database already contains ${t.document_count} documents, skipping migration`),a?.({phase:"complete",current:t.document_count,total:t.document_count,message:`Database ready with ${t.document_count} documents`,percentage:100}),!0;a?.({phase:"loading",current:0,total:100,message:"Loading data...",percentage:10});const r=await fetch("/agentx-benchmark-ui/data/database.json");if(!r.ok)throw new Error(`Failed to fetch database: ${r.status}`);const n=await r.json(),s=(n.benchmark_runs?.length||0)+(n.model_performance?.length||0)+(n.test_results?.length||0)+(n.performance_trends?.length||0);console.log(`Loading ${s} documents into JSONIC using batch insert...`);let o=0;const d=(m,x,u)=>({_type:m,_runId:u,_timestamp:new Date().toISOString(),...x}),l=await j.getDatabase();if(n.benchmark_runs&&n.benchmark_runs.length>0){a?.({phase:"migrating",current:o,total:s,message:"Batch loading benchmark runs...",percentage:20});const m=n.benchmark_runs.map(x=>d("benchmark_run",x));if(l.insert_many){const x=await l.insert_many(JSON.stringify(m)),u=typeof x=="string"?JSON.parse(x):x;(u.success||u.data)&&(o+=m.length,console.log(`Batch loaded ${m.length} benchmark runs`))}else{const x=m.map(u=>j.insert(u));await Promise.all(x),o+=m.length,console.log(`Loaded ${m.length} benchmark runs in parallel`)}}if(n.model_performance&&n.model_performance.length>0){a?.({phase:"migrating",current:o,total:s,message:"Batch loading model performance...",percentage:40});const m=n.model_performance.map(x=>d("model_performance",x,x.run_id));if(l.insert_many){const x=await l.insert_many(JSON.stringify(m)),u=typeof x=="string"?JSON.parse(x):x;(u.success||u.data)&&(o+=m.length,console.log(`Batch loaded ${m.length} model performance records`))}else{const x=m.map(u=>j.insert(u));await Promise.all(x),o+=m.length,console.log(`Loaded ${m.length} model performance records in parallel`)}}if(n.test_results&&n.test_results.length>0){a?.({phase:"migrating",current:o,total:s,message:"Batch loading test results...",percentage:60});const m=n.test_results.map(u=>d("test_result",u,u.run_id)),x=100;for(let u=0;u<m.length;u+=x){const _=m.slice(u,Math.min(u+x,m.length));if(l.insert_many){const f=await l.insert_many(JSON.stringify(_)),k=typeof f=="string"?JSON.parse(f):f;(k.success||k.data)&&(o+=_.length)}else{const f=_.map(k=>j.insert(k));await Promise.all(f),o+=_.length}const C=60+(o-n.benchmark_runs.length-n.model_performance.length)/n.test_results.length*25;a?.({phase:"migrating",current:o,total:s,message:`Processing test results... (${o}/${s})`,percentage:C})}console.log(`Batch loaded ${m.length} test results`)}if(n.performance_trends&&n.performance_trends.length>0){a?.({phase:"migrating",current:o,total:s,message:"Batch loading performance trends...",percentage:85});const m=n.performance_trends.map(x=>d("performance_trend",x));if(l.insert_many){const x=await l.insert_many(JSON.stringify(m)),u=typeof x=="string"?JSON.parse(x):x;(u.success||u.data)&&(o+=m.length,console.log(`Batch loaded ${m.length} performance trends`))}else{const x=m.map(u=>j.insert(u));await Promise.all(x),o+=m.length,console.log(`Loaded ${m.length} performance trends in parallel`)}}const g=await j.getStats();return console.log("Migration complete. Final stats:",g),a?.({phase:"complete",current:s,total:s,message:`âœ… Migration complete! ${s} documents loaded.`,percentage:100}),!0}catch(t){return console.error("Migration failed:",t),a?.({phase:"error",current:0,total:100,message:t instanceof Error?t.message:"Migration failed",percentage:0}),!1}}const ct=new Re({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:3e4}}});function lt(){const[a,t]=h.useState({phase:"idle",current:0,total:0,message:"",percentage:0}),[i,r]=h.useState(!1),[n,s]=h.useState(window.location.pathname);return h.useEffect(()=>{(async()=>{const l=window.location.pathname;if(s(l),l.includes("/jsonic-bench")){r(!0);return}try{Je(m=>{console.log("Worker migration progress:",m),t(m),m.phase==="complete"?setTimeout(()=>{r(!0)},500):m.phase==="error"&&console.error("Worker migration error:",m.message)}),t({phase:"checking",current:0,total:100,message:"Initializing database...",percentage:0}),console.log("ðŸš€ Starting database migration..."),await it(m=>{console.log("Migration progress:",m),t(m),m.phase==="complete"?setTimeout(()=>{r(!0)},500):m.phase==="error"&&console.error("Migration error:",m.message)})?console.log("âœ… Database migration completed successfully"):(console.error("âŒ Database migration failed"),t({phase:"error",current:0,total:100,message:"Database initialization failed",percentage:0}))}catch(g){console.error("âŒ Failed to initialize database:",g),t({phase:"error",current:0,total:100,message:"Database initialization failed",percentage:0})}})()},[]),e.jsx(Te,{client:ct,children:e.jsxs(De,{basename:"/agentx-benchmark-ui/",children:[!i&&!n.includes("/jsonic-bench")&&e.jsx(ot,{...a,onComplete:()=>r(!0)}),e.jsxs($e,{children:[e.jsx(V,{path:"/",element:i?e.jsx(at,{}):null}),e.jsx(V,{path:"/jsonic-bench",element:e.jsx(nt,{})})]}),e.jsx(Oe,{initialIsOpen:!1})]})})}function dt(){return h.useEffect(()=>{console.log("[APP] Application started"),console.log("[APP] Environment:",{mode:"production",isDev:!1,isProd:!0,baseUrl:"/agentx-benchmark-ui/",location:window.location.href,pathname:window.location.pathname,origin:window.location.origin}),console.log("[APP] Browser capabilities:",{serviceWorker:"serviceWorker"in navigator,webWorker:typeof Worker<"u",indexedDB:"indexedDB"in window,localStorage:"localStorage"in window,webAssembly:typeof WebAssembly<"u"})},[]),e.jsxs(e.Fragment,{children:[e.jsx(lt,{}),!1]})}Me.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(dt,{})}));
//# sourceMappingURL=index-BamCvd_C.js.map
